<div class="container">
<script>
function changeGroupVisibility(groupId) {
  $.ajax({  
      type: 'POST',  
      url: '/groups/changeVisibility', 
      data: { group_id: groupId },
      success: function(response) {
      }
  });
}
</script>
<div class="card"> 
  <div>
    <h3 class="groupname"><%= @group.name %></h3>
    <span class="right">  
    	<input id="check<%= @group.name %>" type="checkbox" data-size="small" name="<%= "group" + @group.id.to_s + "VisibilityToggle" %>" value="check<%= @group.name %>" data-off-color="default" onfocus="changeGroupVisibility(<%= @group.id.to_s %>);">
      <script>$("[name='<%= "group" + @group.id.to_s + "VisibilityToggle" %>']").bootstrapSwitch('state', <%= @group.visible.to_s %>, false);</script>
      </input>
      <%= link_to 'Delete', @group, confirm: 'Are you sure you want to delete ' + @group.name + '?', :method => :delete, class: 'btn btn-default btn-danger' %>
    </span>
</div>

<% @members.each do |memb| %>
  <div class='card'>
    <%= memb.name %>
    <span class="pending_friend">
      <% friendRow = GroupMember.where("user_id = ? AND friend_id = ?", current_user.id, memb.id).first %>
    </span>
    <% g_mem_id = @mems.where(friend_id: memb.id.to_i).first.id %>
    <span class="right">  <%= link_to 'Remove', group_members_path+"?gid="+@group.id.to_s+"&mid="+g_mem_id.to_s,
      confirm: 'Are you sure you want to remove '+memb.name+' from '+@group.name+'?', :method => :delete, class: 'btn btn-default btn-danger' %> </span>
  </div>
<% end %>
<!-- </div> -->
<div class="card">
  <h4>Add a friend to <%= @group.name %></h4>
  <%= form_tag @group, method: "get" do %>
    <div class="form-group">
        <%= text_field_tag :search, nil, class: "form-control", :placeholder=> "Search for a friend to add to " + @group.name  %>
    </div>
    <%= submit_tag "Search", class: "btn btn-success"%>
  <% end %>
  <br>
  <% unless @my_friends.nil? %>
    <% @my_friends.each do |member| %>
      <% if member.id != current_user.id %>
        <div class="card">
          <%= member.name %>
          <span class="right">
          <%= form_tag group_members_path, method: "post" %>
          <%= hidden_field_tag  'group_id', @group.id %>
          <%= hidden_field_tag  'friend_id', member.id %>
          <%= submit_tag "Add", class: "btn btn-primary"%>
          </span>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>
</div>